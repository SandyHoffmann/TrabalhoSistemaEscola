<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Trabalho</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"
    />
    <link
      rel="shortcut icon"
      href="https://img.icons8.com/ios/250/000000/classroom.png"
    />
    
      <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300&display=swap" rel="stylesheet">
      
    <link rel="stylesheet" href="css.css" />
    <link rel="stylesheet" href="cssindex.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  </head>
  <body>
    <nav class="navbar navbar-inverse">
      <div class="container-fluid">
        <div class="navbar-header">
          <button
            type="button"
            class="navbar-toggle"
            data-toggle="collapse"
            data-target="#myNavbar"
          >
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Class</a>
        </div>
        <div class="collapse navbar-collapse" id="myNavbar">
          <ul
            id="Home"
            class="nav navbar-nav"
            style="background-color: #ffb5a7"
          >
            <li class="active">
              <a href="#" style="background-color: #ffb5a7">Home</a>
            </li>
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#"
                >Page 1 <span class="caret"></span
              ></a>
              <ul class="dropdown-menu" style="background-color: black">
                <li><a href="#">Page 1-1</a></li>
                <li><a href="#">Page 1-2</a></li>
                <li><a href="#">Page 1-3</a></li>
              </ul>
            </li>
            <li><a href="#">Page 2</a></li>
            <li><a href="#">Page 3</a></li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li>
              <a href="#"
                ><span class="glyphicon glyphicon-user"></span> Sign Up</a
              >
            </li>
            <li>
              <a href="#"
                ><span class="glyphicon glyphicon-log-in"></span> Login</a
              >
            </li>
          </ul>
        </div>
      </div>
    </nav>

   <center> <h1 class="nomeTurma"></h1>
    <h2 class="codigoTurma"></h2></center>

    <table class="tabela">
      <tr>
        <th>Matrícula</th>
        <th>Nome</th>
        <th>Nota 1</th>
        <th>Nota 2</th>
        <th>Nota 3</th>
        <th>Média Final</th>
        <th>Deletar</th>
      </tr>
    </table>
    <div class="maisAluno">
      <button type="button" class="btn btn" id="botaomaisAluno" data-toggle="modal" data-target=".bd-example-modal-lg-m">+</button>
    </div>
    <div class="modal fade bd-example-modal-lg-m" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="titulo-cadastro">
            <h1>Cadastrar novos alunos</h1>
          </div>
          <form>
            <div class="form-row">
              <div class="form-group col-md-6">
                <label for="inputMatricula4">Matrícula</label>
                <input type="matricula" class="form-control" id="inputMatricula4" placeholder="Digite a matrícula do aluno">
              </div>
              <div class="form-group col-md-6">
                <label for="inputTelefone4">Telefone</label>
                <input type="telefone" class="form-control" id="inputTelefone4" placeholder="Digite o número do telefone do aluno">
              </div>
            </div>
            <div class="form-group">
              <label for="inputNome">Nome</label>
              <input type="nome" class="form-control" id="inputNome" placeholder="Digite o nome do aluno">
            </div>
            <div class="form-group">
              <label for="inputEmail">E-mail</label>
              <input type="email" class="form-control" id="inputEmail" placeholder="Digite o e-mail do aluno">
            </div>
            <div class="form-group" id="centralizarBotao">
            <button type="submit" class="btn btn" id="botaoAluno">Enviar</button>
            </div>
          </form>

        </div>
      </div>
    </div>
    <footer class="site-footer">
      <div class="container">
        <div class="row">
          <div class="col-sm-12 col-md-6">
            <h6>Sobre</h6>
            <p class="text-justify">
              Lorem ipsum dolor sit, amet consectetur adipisicing elit. Labore
              animi inventore iure nemo similique reprehenderit possimus aperiam
              quod vero exercitationem quo dolorum expedita sint, est ea atque
              modi unde accusantium.
            </p>
          </div>

          <div class="col-xs-6 col-md-3">
            <h6>Outra coisa se precisar</h6>
            <ul class="footer-links">
              <li><a href="#">algo</a></li>
              <li><a href="#">algo</a></li>
              <li><a href="#">algo</a></li>
            </ul>
          </div>
          <div>
            <h6>Links?</h6>
            <ul class="footer-links">
              <li><a href="#">algo</a></li>
              <li><a href="#">algo</a></li>
              <li><a href="#">algo</a></li>
            </ul>
          </div>
        </div>
        <hr />
      </div>
      <div class="container">
        <div class="row">
          <div class="col-md-8 col-sm-6 col-xs-12">
            <p class="copyright-text">Copyright by a gente</p>
          </div>
          <div>
            <ul class="social-icons">
              <li>
                <a class="facebook" href="#"><i class="fa fa-facebook"></i></a>
              </li>
              <li>
                <a class="twitter" href="#"><i class="fa fa-twitter"></i></a>
              </li>
              <li>
                <a class="dribbble" href="#"><i class="fa fa-dribbble"></i></a>
              </li>
              <li>
                <a class="linkedin" href="#"><i class="fa fa-linkedin"></i></a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <script type="module">
      import { Aluno } from './js/aluno.js'
      import { Turma } from './js/turma.js'
      import { criarInst, classesInitTurma, classesInitAlunos, armazenarValores } from './js/backend.js'
      let timer1 = setTimeout(criarInst,1)
      let timer2 = setTimeout(iniciar, 2)
      console.log(classesInitTurma)
      function iniciar() {
          let query = new URLSearchParams(location.search)
          let idTurma = query.get("codigoTurma")
          let turma = JSON.parse(localStorage.getItem("listaTurmas"))
          let pNomeTurma = document.querySelector(".nomeTurma")
          let pCodTurma = document.querySelector(".codigoTurma")
          console.log(classesInitTurma[0])
          let cont = -1
          for (let x of classesInitTurma) {
              cont+=1
              if (x.codigoTurma == idTurma) {
                  pNomeTurma.textContent = x.nomeTurma
                  pCodTurma.textContent = x.codigoTurma
                  console.log(classesInitAlunos)
                  let tabela = document.querySelector("table")
                    for (let z=0;z<classesInitAlunos[cont].length;z++){
                        let fileira = document.createElement("tr")
                        tabela.append(fileira)
                          let a = document.createElement("a")
                          console.log(classesInitAlunos[cont][z].matricula)
                          fileira.innerHTML += `<td><a href="pagAlunos.html?matricula=${classesInitAlunos[cont][z].matricula}">${classesInitAlunos[cont][z].nome}</a></td>`
                          fileira.innerHTML += `<td>${classesInitAlunos[cont][z].matricula}</td>`
                          if (classesInitAlunos[cont][z].nota){
                            fileira.innerHTML += `<td>${classesInitAlunos[cont][z].nota[0]}</td>`
                            fileira.innerHTML += `<td>${classesInitAlunos[cont][z].nota[1]}</td>`
                            fileira.innerHTML += `<td>${classesInitAlunos[cont][z].nota[2]}</td>`
                            fileira.innerHTML += `<td>${classesInitAlunos[cont][z].media}</td>`
                          } else{
                            fileira.innerHTML += `<td>Não se tem Notas</td>`
                            fileira.innerHTML += `<td>Não se tem Notas</td>`
                            fileira.innerHTML += `<td>Não se tem Notas</td>`
                            fileira.innerHTML += `<td>Não se tem Notas</td>`
                          }
                          fileira.innerHTML += `<td><a id = "${classesInitAlunos[cont][z].matricula}" class = "Deletar">deletar</a></td>`
                          let deletar = document.querySelectorAll(".Deletar")[z]
                          console.log(deletar)
                          deletar.addEventListener("click", function () { deletando(deletar.id) })
                          console.log(fileira)
                  }
                  
              }
          }
      }
      let botao = document.querySelector("#botaoAluno")
      botao.addEventListener("click", (event) => {
          let query = new URLSearchParams(location.search)
          let idTurma = query.get("codigoTurma")
          let turma2 = JSON.parse(localStorage.getItem("listaTurmas"))
          for (let x of classesInitTurma) {
              if (x.codigoTurma == idTurma) {
                  let input1 = document.querySelector("#inputMatricula4").value
                  let input2 = document.querySelector("#inputNome").value
                  let input3 = document.querySelector("#inputTelefone4").value
                  let input4 = document.querySelector("#inputEmail").value

                  
                  let aluno = new Aluno(input1,input2,input3,input4)
                  x.cadastrarAluno(aluno)
                  console.log(classesInitTurma)
                  armazenarValores(classesInitTurma)
                  return "ok"
              }
          }
          console.log(turma)
      })
      function deletando(deletar) {
          console.log(deletar)
          let query = new URLSearchParams(location.search)
          let idTurma = query.get("codigoTurma")
          let tag = document.getElementById(deletar);
          for (let x of classesInitTurma) {
              if (x.codigoTurma == idTurma) {
                  let matricula = tag.id
                  console.log(deletar)
                  for (let i = 0; i < x.alunos.length; i++) {
                      if (x.alunos[i].matricula == deletar) {
                          alert("a")
                          x.removerAluno(matricula)
                          armazenarValores(classesInitTurma)
                      }
                  }
              }
          }
      }
  </script>
  </body>
</html>
