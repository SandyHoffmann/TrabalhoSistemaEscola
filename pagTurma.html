<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <p class="id"></p>
    <p class="nome"></p>
    <input type="text" class="matricula">
    <input type="text" class="nomeinput">
    <button>Clique</button>

    <script type="module">
        import { Aluno } from './js/aluno.js'
        import { Turma } from './js/turma.js'
        import { criarInst, classesInitTurma, classesInitAlunos, armazenarValores } from './js/backend.js'
        let timer2 = setTimeout(criarInst, 1)

        window.addEventListener("load", () => {
            let query = new URLSearchParams(location.search)
            let idTurma = query.get("codigoTurma")
            let turma = JSON.parse(localStorage.getItem("listaTurmas"))
            console.log(turma)
            for (let x of turma) {
                console.log(x.codigoTurma)
                if (x.codigoTurma == idTurma) {
                    document.querySelector(".id").textContent = x.codigoTurma
                    document.querySelector(".nome").textContent = x.nomeTurma
                    console.log(x.alunos)
                    for (let i = 0; i < x.alunos.length; i++) {
                        let a = document.createElement("a")
                        a.href = `pagAlunos.html?matricula=${x.alunos[i].matricula}`
                        a.innerHTML = x.alunos[i].nome + "<br>"
                        document.body.append(a)
                    }
                }
            }
        })
        let botao = document.querySelector("button")
        botao.addEventListener("click", (event) => {
            let query = new URLSearchParams(location.search)
            let idTurma = query.get("codigoTurma")
            let turma2 = JSON.parse(localStorage.getItem("listaTurmas"))
            console.log(classesInitTurma)
            for (let x of classesInitTurma) {
                console.log(x)
                if (x.codigoTurma == idTurma) {
                    let input1 = document.querySelector(".matricula").value
                    let input2 = document.querySelector(".nomeinput").value
                    console.log(input1)
                    let aluno = new Aluno(input1, input2)
                    console.log(aluno)
                    x.cadastrarAluno(aluno)
                    console.log(classesInitTurma)
                    armazenarValores(classesInitTurma)
                    // armazenarValores(classesInitTurma)
                    // criarInst()
                    return "ok"
                }
            }
            console.log(turma)
        })

    </script>

</body>

</html>