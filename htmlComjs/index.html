<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Trabalho</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"
    />
    <link
      rel="shortcut icon"
      href="https://img.icons8.com/ios/250/000000/classroom.png"
    />
    <link rel="stylesheet" href="css.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="cssindex.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300&display=swap" rel="stylesheet">
  </head>
  <body>
    <nav class="navbar navbar-inverse">
      <div class="container-fluid">
        <div class="navbar-header">
          <button
            type="button"
            class="navbar-toggle"
            data-toggle="collapse"
            data-target="#myNavbar"
          >
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">School</a>
        </div>
        <div class="collapse navbar-collapse" id="myNavbar">
          <ul
            id="Home"
            class="nav navbar-nav"
            style="background-color: #ffb5a7"
          >
            <li class="active">
              <a href="#" style="background-color: #ffb5a7">Home</a>
            </li>
          <ul class="nav navbar-nav navbar-right">
          </ul>
        </div>
      </div>
    </nav>
    <main>
    <div class="container">
      <div class="row" id="fileira">
      </div>
    </div>
    <div class="mais">
      <button type="button" class="btn btn" id="botaomais" data-toggle="modal" data-target=".bd-example-modal-lg">+</button>
    </div>
        <div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <div class="titulo-cadastro">
                <h1>Cadastrar novas turmas</h1>
              </div>
              <form>
                <div class="form-group">
                  <label for="codigoTurma">Digite o código da turma</label>
                  <input type="email" class="form-control" id="codigoTurma" aria-describedby="emailHelp" placeholder="Código da turma">
                </div>
                <div class="form-group">
                  <label for="nomeTurma">Digite o nome da turma</label>
                  <input type="text" class="form-control" id="nomeTurma" placeholder="Nome da turma">
                </div>
                <div id="botao">
                  <button type="submit" class="btn btn" id="botaoCadastro">Submit</button>
                </div>
                
              </form>
            </div>
          </div>
        </div>
      </main>

    <footer class="site-footer">
      <div class="container">
        <div class="row">
          <div class="col-sm-12 col-md-6">
            <h6>Sobre</h6>
            <p class="text-justify">
              Lorem ipsum dolor sit, amet consectetur adipisicing elit. Labore
              animi inventore iure nemo similique reprehenderit possimus aperiam
              quod vero exercitationem quo dolorum expedita sint, est ea atque
              modi unde accusantium.
            </p>
          </div>

          <div class="col-xs-6 col-md-3">
            <h6>Outra coisa se precisar</h6>
            <ul class="footer-links">
              <li><a href="#">algo</a></li>
              <li><a href="#">algo</a></li>
              <li><a href="#">algo</a></li>
            </ul>
          </div>
          <div>
            <h6>Links?</h6>
            <ul class="footer-links">
              <li><a href="#">algo</a></li>
              <li><a href="#">algo</a></li>
              <li><a href="#">algo</a></li>
            </ul>
          </div>
        </div>
        <hr />
      </div>
      <div class="container">
        <div class="row">
          <div class="col-md-8 col-sm-6 col-xs-12">
            <p class="copyright-text">Copyright by a gente</p>
          </div>
          <div>
            <ul class="social-icons">
              <li>
                <a class="facebook" href="#"><i class="fa fa-facebook"></i></a>
              </li>
              <li>
                <a class="twitter" href="#"><i class="fa fa-twitter"></i></a>
              </li>
              <li>
                <a class="dribbble" href="#"><i class="fa fa-dribbble"></i></a>
              </li>
              <li>
                <a class="linkedin" href="#"><i class="fa fa-linkedin"></i></a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <script type="module">
      import { Aluno } from './js/aluno.js'
      import { Turma } from './js/turma.js'
      import { cadastrarTurma, armazenarValores, armazenarValorInicial, verificar, criarInst, classesInitTurma, classesInitAlunos } from './js/backend.js'

      let timer = setTimeout(verificar, 1000)
      let timer2 = setTimeout(criarInst, 1000)

      let lista_geral = JSON.parse(localStorage.getItem("listaTurmas"))
      let lista_conthtml = document.querySelector(".row")
    for (let turma of lista_geral) {
        lista_conthtml.innerHTML +=  `<div class="card" style="width: 18rem;">`+
        `<div class="card-header"></div>`+
              `<div class="card-body">`+
              `<h5 class="card-title">${turma.codigoTurma}</h5>`+
              `<p class="card-text"><a class="nomeTurma">${turma.nomeTurma}</a></p>`+
              `<a class="btn btn" id="botao" href="paginaTurma.html?codigoTurma=${turma.codigoTurma}">Ver Alunos</a>`+
         `</div>`+
        `</div>`
      }

      let botao = document.querySelector("#botaoCadastro")

      botao.addEventListener("click", (event) => {
          let input1 = document.querySelector("#codigoTurma")
          let input2 = document.querySelector("#nomeTurma")
          console.log(input1.value)
          cadastrarTurma(input1.value, input2.value)
          window.location.reload()

      })
  </script>

  <script>
      class Turma {
        constructor(codigoTurma, nomeTurma) {
            this.codigoTurma = codigoTurma
            this.nomeTurma = nomeTurma
            this.alunos = []
        }
        cadastrarAluno(aluno) {
            for (let estudante of this.alunos) {
                if (estudante.matricula == aluno.matricula) {
                    return ("Não é possivel cadastrar o aluno!")
                }
            }
            this.alunos.push(aluno)
            return ("Deu certo!")
        }
        removerAluno(matriculaAluno) {
            for (let x = 0; x < (this.alunos.length); x += 1) {
                if (matriculaAluno == this.alunos[x].matricula) {
                    this.alunos.splice(x, 1)
                    armazenarValores()
                    return ("Deu certo!")
                }
            }
            return ("Não foi possivel remover o aluno!")
        }
    }

      function instanciaTurmas(turmas) {
          let turmasObjeto = []
          for (let turma of turmas) {
              let turmaObjeto = new Turma(turma.codigoTurma, turma.nomeTurma, turma.alunos)        
              turmasObjeto.push(turmaObjeto)
          }
          return turmasObjeto
      }


      let turmas = JSON.parse(localStorage.getItem("listaTurmas"))

      let turmasObjeto = instanciaTurmas(turmas)
      
      console.log(turmasObjeto)


      class Aluno {
      #nota
      #media
    constructor(matricula, nome, telefone, email, notas=[], media=0) {
        this.matricula = matricula;
        this.#nota = notas;
        this.#media = media;
        this.nome = nome;
        this.telefone = telefone;
        this.email = email;

    }
    editarInformacoes(nome, telefone, email) {
        if (!nome == this.nome) {
        this.nome = nome;
        }
        if (!telefone == this.telefone) {
        this.telefone = telefone;
        }
        if (!email == this.email) {
        this.email = email;
        }
    }
    calculaMedia() {
        let soma = 0;
        for (let x = 0; x < this.#nota.length; x++) {
            soma += this.#nota[x];
            }
        let media = soma / this.#nota.length;
        this.#media = media
        return(this.#media)
    }

    cadastraNotas(n1, n2, n3) {
        this.#nota[0] = parseInt(n1)
        this.#nota[1] = parseInt(n2)
        this.#nota[2] = parseInt(n3)
        alert(this.#nota)
        return(this.#nota)
    }
}

      function instanciaAlunos(turmas) {        
        for (let turma of turmas) {
          for (let i = 0; i < turma.alunos.length; i++) {            
            turma.alunos[i] = new Aluno(turma.alunos[i].matricula, turma.alunos[i].nome, turma.alunos[i].telefone, turma.alunos[i].email)
          }
        }
      }

      instanciaAlunos(turmas)

      console.log(turmas)
  </script>
  </body>
</html>
